<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8" />
    <title>Form handling with JavaScript</title>
    <link href="./css3/class68.css" rel="stylesheet" type="text/css">
<script>

</script>
</head>
<body>
    <h2>서적 주문 양식</h2>
    <form action="ex402_result.html" method="get">
        <!-- 입력을 할 때 마다 변경됩니다. -->
        <table>
            <tr>
                <th>책 제목</th>
                <th>가격</th>
                <th>수량</th>
                <th>합계</th>
            </tr>
            <tr>
                <td>4차 산업</td>
                <td class="price">30,000원</td>
                <td><input id="book1" type="text" size="2" value="0" onclick="this.select();"></td>
                <!-- 이벤트 핸들러를 직접 기술하여 등록 방식 
                        this.select()는 각 서적 수량을 표시하는 텍스트 박스를 
                            클릭하면 그 값이 선택되도록 하는 기능을 갖는다.
                        this는 <input> 요소의 DOM을 가리키게 된다.
                            즉, 자신이 속한 DOM을 가리키는 것이다.
                -->
                <td><input id="book1Total" type="text" size="6" value="0" readonly>원</td>
            </tr>
            <tr>
                <td>다이어트</td>
                <td class="price">27,000원</td>
                <td><input id="book2" type="text" size="2" value="0" onclick="this.select();"></td>
                <td><input id="book2Total" type="text" size="6" value="0" readonly>원</td>
            </tr>
            <tr>
                <td>윤식당</td>
                <td class="price">25,000원</td>
                <td><input id="book3" type="text" size="2" value="0" onclick="this.select();"></td>
                <td><input id="book3Total" type="text" size="6" value="0" readonly>원</td>
            </tr>
            <tr>
                <td>합계</td>
                <td>&nbsp;</td>
                <td><input id="totalNumber" type="text" size="2" value="0" readonly"></td>
                <td><input id="totalPrice" type="text" size="6" value="0" readonly>원</td>
            </tr>
        </table>
        <br>
        <input type="reset" value="초기화">
        <input type="submit" value="제출">
    </form>

<script>
    let totalNumber = document.getElementById('totalNumber');
    let totalPrice = document.getElementById('totalPrice');

    function updateAll() {
        var num = 0;
        var total = 0;
        for(var i = 0; i < 3; i++) {
            var book = document.getElementById('book'+Number(i+1));
            var bookTotal = document.getElementById('book'+Number(i+1)+'Total');
            var price = document.getElementsByClassName("price")[i].textContent;
            price = price.replace(/,|원/g, "");
            // var input = document.getElementsByTagName('input');
            // input[i].addEventListener('select', inputEvent);
            bookTotal.value = Number(book.value) * Number(price);
            num += Number(book.value);
            total += Number(bookTotal.value);
        }

        totalNumber.value = 0;   totalPrice.value  = 0; 
        totalNumber.value = num; totalPrice.value  = total;
    } // function end

    document.getElementsByTagName('form')[0].addEventListener('input', updateAll);
</script>

</body>
</html>